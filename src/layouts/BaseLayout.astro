---
// Styles
import "../styles/main.scss";

// Components
import CommonHead from "../components/CommonHead.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";

// Props
interface Props {
	title: string;
	description: string;
	includeNavigation?: boolean;
	includeFooter?: boolean;
}

const {
	title,
	description,
	includeNavigation = true,
	includeFooter = true,
} = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<CommonHead title={title} description={description} />
	</head>
	<body>
		{includeNavigation && <Navigation />}
		<main>
			<slot />
		</main>
		{includeFooter && <Footer />}
	</body>
</html>

<script>
	// Store the current URL before any navigation happens
	document.addEventListener('click', (e) => {
		const target = e.target as HTMLElement;
		const link = target.closest('a');
		
		if (link && !window.location.pathname.includes('404')) {
			console.log('Storing current URL before navigation:', window.location.href);
			sessionStorage.setItem('lastVisitedUrl', window.location.href);
		}
	});

	// Setup Intersection Observer
	import setupIntersectionObserver from "../scripts/intersection-observer";
	setupIntersectionObserver();
</script>
